<!DOCTYPE html>
<html>

<head>
    <title>Your Web Page</title>
    <script src="/jquery3.6.0.min.js"></script>
</head>

<body>
    <label for="runbackSpeed">RunBack Speed (hz)</label>
    <input type="number" id="runbackSpeed"><br />

    <label for="greatCircleRadius">Great Circle Radius (mm)</label>
    <input type="number" id="greatCircleRadius"><br />

    <label for="limitToMiddleDistance">Limit To Middle Distance (mm)</label>
    <input type="number" id="limitToMiddleDistance"><br />


    <label for="raGuideRate">RA Guide Sidereal Multiplier</label>
    <input type="number" id="raGuideRate"><br />

        <label for="acceleration">Acceleration</label>
        <input type="number" id="acceleration"><br />

    <label for="position">Position (mm):</label>
    <span id="position">0</span><br />
    <label for="velocity">Velocity (mm/minute):</label>
    <span id="velocity">0</span><br />
    <button id="home">Home</button>
    <button id="center">Center</button>
    <button id="park">Park (end-5m)</button>
    <br>
    <a href="/chart.htm">Speed vs position chart</a>

    <script>
        var previousPosition = -1;

        function update() {
            console.log("Update");

            $.getJSON("/getStatus").done(function (data) {
                console.log("Runback val: ", data.runbackSpeed);
                if (!$("#runbackSpeed").is(":focus")) {
                    console.log("Update runback");
                    $("#runbackSpeed").val(data.runbackSpeed);
                }
                if (!$("#limitToMiddleDistance").is(":focus")) {
                    $("#limitToMiddleDistance").val(data.limitToMiddleDistance);
                }

                if (!$("#greatCircleRadius").is(":focus")) {
                    $("#greatCircleRadius").val(data.greatCircleRadius);
                }

                if (!$("#raGuideRate").is(":focus")) {
                    $("#raGuideRate").val(data.raGuideRate);
                }

                 if (!$("#acceleration").is(":focus")) {
                    $("#acceleration").val(data.acceleration);
                }


                $("#position").text(data.position);
                $("#velocity").text(data.velocity);

            }).fail(function (jqxhr, textStatus, error) {
                console.log("Request Failed: " + textStatus + ", " + error);
            });;
        }
        $("#home").click(function () {
            $.post("/home");
        });
        $("#center").click(function () {
            $.post("/center");
        });
        $("#park").click(function () {
            $.post("/park");
        });
        $("#resetButton").click(function () {
            chartData.labels = [];
            chartData.datasets[0].data = [];
            chart.update();
        });

        $("#runbackSpeed, #limitToMiddleDistance, #greatCircleRadius,#raGuideRate, #acceleration").change(function () {
            $.post("/" + $(this).attr('id'), { value: $(this).val() });
        });
        setInterval(update, 1000);
    </script>
</body>

</html>